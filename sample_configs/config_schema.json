{"title": "Configuration", "description": "Root configuration for DeepErwin", "type": "object", "properties": {"physical": {"$ref": "#/definitions/PhysicalConfig"}, "pre_training": {"title": "Pre Training", "default": {"use": true, "mcmc": {"n_inter_steps": 1, "n_burn_in": 0, "max_age": 20, "stepsize_update_interval": 1000, "n_walkers": 2048, "target_acceptance_rate": 0.5, "min_stepsize_scale": 0.01, "max_stepsize_scale": 1.0, "proposal": {"name": "normal"}}, "n_epochs": 1000, "optimizer": {"name": "adam", "learning_rate": 0.0003, "lr_schedule": {"name": "fixed"}, "scaled_modules": null, "scale_lr": 1.0}, "use_only_leading_determinant": true, "baseline": {"name": "casscf", "basis_set": "6-311G", "cusps": {"use": true, "cusp_type": "mo", "r_cusp_el_ion_scale": 1.0}, "only_hf": false}}, "allOf": [{"$ref": "#/definitions/PreTrainingConfig"}]}, "optimization": {"title": "Optimization", "default": {"mcmc": {"n_inter_steps": 20, "n_burn_in": 1000, "max_age": 20, "stepsize_update_interval": 100, "n_walkers": 2048, "target_acceptance_rate": 0.5, "min_stepsize_scale": 0.01, "max_stepsize_scale": 1.0, "proposal": {"name": "normal"}}, "optimizer": {"name": "kfac", "learning_rate": 0.1, "lr_schedule": {"name": "inverse", "decay_time": 6000.0}, "momentum": 0.0, "norm_constraint": 0.001, "damping": 0.001, "damping_scheduler": false, "estimation_mode": "fisher_exact", "register_generic": false, "update_inverse_period": 1, "n_burn_in": 0, "min_damping": 0.0001, "curvature_ema": 0.95, "internal_optimizer": {"name": "sgd", "learning_rate": 1.0, "lr_schedule": {"name": "fixed"}, "scaled_modules": null, "scale_lr": 1.0}}, "n_epochs": 60000, "n_epochs_prev": 0, "use_batch_reweighting": false, "checkpoints": {"replace_every_n_epochs": 1000, "keep_every_n_epochs": 50000, "additional_n_epochs": []}, "clipping": {"name": "tanh", "width_metric": "std", "center": "mean", "from_previous_step": true, "clip_by": 5.0}, "intermediate_eval": null, "shared_optimization": null}, "allOf": [{"$ref": "#/definitions/OptimizationConfig"}]}, "evaluation": {"title": "Evaluation", "default": {"mcmc": {"n_inter_steps": 20, "n_burn_in": 500, "max_age": 100, "stepsize_update_interval": 100, "n_walkers": 2048, "target_acceptance_rate": 0.5, "min_stepsize_scale": 0.01, "max_stepsize_scale": 1.0, "proposal": {"name": "normal"}}, "n_epochs": 10000, "calculate_energies": true, "forces": null}, "allOf": [{"$ref": "#/definitions/EvaluationConfig"}]}, "model": {"title": "Model", "default": {"features": {"use_rbf_features": false, "n_rbf_features": 0, "use_distance_features": true, "use_el_ion_differences": true, "use_el_el_differences": false, "use_el_el_spin": false, "use_local_coordinates": true, "n_one_el_features": 0, "n_ion_features": 32, "concatenate_el_ion_features": true, "n_hidden_one_el_features": [], "eps_dist_feat": 0.01, "distance_feature_powers": [1], "name": "dpe4"}, "embedding": {"name": "dpe4", "n_hidden_one_el": [256, 256, 256, 256], "n_hidden_two_el": [32, 32, 32], "n_hidden_el_ions": [32, 32, 32], "n_iterations": 4, "use_el_ion_stream": true, "use_average_h_one": true, "initialization": {"bias_scale": 0.0, "weight_scale": "glorot", "weight_distribution": "uniform"}, "use_average_h_two": false, "use_h_one": true, "use_h_two_same_diff": true, "use_schnet_features": true, "sum_schnet_features": false, "emb_dim": 32, "use_linear_out": false, "use_w_mapping": true}, "orbitals": {"baseline_orbitals": null, "envelope_orbitals": {"envelope_type": "isotropic_exp", "n_hidden": [], "use_bias": false, "initialization": "constant"}, "n_determinants": 32, "use_full_det": true}, "mlp": {"activation": "tanh", "init_bias_scale": 0.0, "init_weights_scale": "fan_avg", "init_weights_distribution": "uniform"}, "jastrow": null, "use_el_el_cusp_correction": false, "name": "dpe4"}, "anyOf": [{"$ref": "#/definitions/ModelConfigDeepErwin4"}, {"$ref": "#/definitions/ModelConfigFermiNet"}, {"$ref": "#/definitions/ModelConfigDeepErwin1"}]}, "logging": {"title": "Logging", "default": {"tags": [], "log_opt_state": true, "basic": {"n_skip_epochs": 9, "log_to_stdout": true, "log_level": "DEBUG", "fname": "log.out"}, "wandb": null, "pickle": {"n_skip_epochs": 0, "fname": "results.bz2"}}, "allOf": [{"$ref": "#/definitions/LoggingConfig"}]}, "computation": {"title": "Computation", "default": {"use_gpu": true, "require_gpu": true, "n_devices": null, "force_device_count": false, "disable_jit": false, "float_precision": "float32", "disable_tensor_cores": true, "use_profiler": false}, "allOf": [{"$ref": "#/definitions/ComputationConfig"}]}, "dispatch": {"title": "Dispatch", "default": {"system": "auto", "queue": "default", "time": "3day", "conda_env": "jax", "split_opt": null, "eval_epochs": null}, "allOf": [{"$ref": "#/definitions/DispatchConfig"}]}, "reuse": {"title": "Reuse", "anyOf": [{"$ref": "#/definitions/RestartConfig"}, {"$ref": "#/definitions/ReuseConfig"}]}, "comment": {"title": "Comment", "type": "string"}, "experiment_name": {"title": "Experiment Name", "type": "string"}}, "additionalProperties": false, "definitions": {"PhysicalConfigChange": {"title": "PhysicalConfigChange", "description": "Base class for all config models", "type": "object", "properties": {"R": {"title": "R", "type": "array", "items": {"type": "array", "items": {"type": "number"}}}, "E_ref": {"title": "E Ref", "type": "number"}, "comment": {"title": "Comment", "type": "string"}}, "additionalProperties": false}, "PhysicalConfig": {"title": "PhysicalConfig", "description": "Base class for all config models", "type": "object", "properties": {"name": {"title": "Name", "type": "string"}, "R": {"title": "R", "type": "array", "items": {"type": "array", "items": {"type": "number"}}}, "Z": {"title": "Z", "type": "array", "items": {"type": "integer"}}, "n_electrons": {"title": "N Electrons", "type": "integer"}, "n_up": {"title": "N Up", "type": "integer"}, "el_ion_mapping": {"title": "El Ion Mapping", "type": "array", "items": {"type": "integer"}}, "n_cas_electrons": {"title": "N Cas Electrons", "type": "integer"}, "n_cas_orbitals": {"title": "N Cas Orbitals", "type": "integer"}, "E_ref": {"title": "E Ref", "type": "number"}, "E_ref_source": {"title": "E Ref Source", "type": "string"}, "comment": {"title": "Comment", "type": "string"}, "changes": {"title": "Changes", "type": "array", "items": {"$ref": "#/definitions/PhysicalConfigChange"}}}, "additionalProperties": false}, "MCMCSimpleProposalConfig": {"title": "MCMCSimpleProposalConfig", "description": "Base class for all config models", "type": "object", "properties": {"name": {"title": "Name", "default": "normal", "enum": ["normal", "cauchy", "normal_one_el"], "type": "string"}}, "additionalProperties": false}, "LocalStepsizeProposalConfig": {"title": "LocalStepsizeProposalConfig", "description": "Config for a local stepsize proposal rule for MCMC. Stepsize depends on distance to closest nuclei", "type": "object", "properties": {"name": {"title": "Name", "default": "local", "enum": ["local", "local_one_el"], "type": "string"}, "r_min": {"title": "R Min", "default": 0.1, "type": "number"}, "r_max": {"title": "R Max", "default": 1, "type": "number"}}, "additionalProperties": false}, "MCMCLangevinProposalConfig": {"title": "MCMCLangevinProposalConfig", "description": "Base class for all config models", "type": "object", "properties": {"name": {"title": "Name", "default": "langevin", "enum": ["langevin"], "type": "string"}, "langevin_scale": {"title": "Langevin Scale", "default": 1.0, "type": "number"}, "r_min": {"title": "R Min", "default": 0.2, "type": "number"}, "r_max": {"title": "R Max", "default": 2.0, "type": "number"}}, "additionalProperties": false}, "MCMCConfigPreTrain": {"title": "MCMCConfigPreTrain", "description": "Config for Markov-Chain-Monte-Carlo integration", "type": "object", "properties": {"n_inter_steps": {"title": "N Inter Steps", "default": 1, "type": "integer"}, "n_burn_in": {"title": "N Burn In", "default": 0, "type": "integer"}, "max_age": {"title": "Max Age", "default": 20, "type": "integer"}, "stepsize_update_interval": {"title": "Stepsize Update Interval", "default": 1000, "type": "integer"}, "n_walkers": {"title": "N Walkers", "default": 2048, "type": "integer"}, "target_acceptance_rate": {"title": "Target Acceptance Rate", "default": 0.5, "type": "number"}, "min_stepsize_scale": {"title": "Min Stepsize Scale", "default": 0.01, "type": "number"}, "max_stepsize_scale": {"title": "Max Stepsize Scale", "default": 1.0, "type": "number"}, "proposal": {"title": "Proposal", "default": {"name": "normal"}, "anyOf": [{"$ref": "#/definitions/MCMCSimpleProposalConfig"}, {"$ref": "#/definitions/LocalStepsizeProposalConfig"}, {"$ref": "#/definitions/MCMCLangevinProposalConfig"}]}}, "additionalProperties": false}, "ConstantLRSchedule": {"title": "ConstantLRSchedule", "description": "Base class for all config models", "type": "object", "properties": {"name": {"title": "Name", "default": "fixed", "enum": ["fixed"], "type": "string"}}, "additionalProperties": false}, "InverseLRScheduleConfig": {"title": "InverseLRScheduleConfig", "description": "Base class for all config models", "type": "object", "properties": {"name": {"title": "Name", "default": "inverse", "enum": ["inverse"], "type": "string"}, "decay_time": {"title": "Decay Time", "default": 6000.0, "type": "number"}}, "additionalProperties": false}, "_OptimizerConfigAdamForPretraining": {"title": "_OptimizerConfigAdamForPretraining", "description": "Base class for all config models", "type": "object", "properties": {"name": {"title": "Name", "default": "adam", "enum": ["adam"], "type": "string"}, "learning_rate": {"title": "Learning Rate", "default": 0.0003, "type": "number"}, "lr_schedule": {"title": "Lr Schedule", "default": {"name": "fixed"}, "anyOf": [{"$ref": "#/definitions/ConstantLRSchedule"}, {"$ref": "#/definitions/InverseLRScheduleConfig"}]}, "scaled_modules": {"title": "Scaled Modules", "type": "array", "items": {"type": "string"}}, "scale_lr": {"title": "Scale Lr", "default": 1.0, "type": "number"}}, "additionalProperties": false}, "StandardOptimizerConfig": {"title": "StandardOptimizerConfig", "description": "Base class for all config models", "type": "object", "properties": {"name": {"title": "Name", "default": "adam", "enum": ["adam", "rmsprop_momentum", "sgd"], "type": "string"}, "learning_rate": {"title": "Learning Rate", "default": 0.001, "type": "number"}, "lr_schedule": {"title": "Lr Schedule", "default": {"name": "inverse", "decay_time": 6000.0}, "anyOf": [{"$ref": "#/definitions/InverseLRScheduleConfig"}, {"$ref": "#/definitions/ConstantLRSchedule"}]}, "scaled_modules": {"title": "Scaled Modules", "type": "array", "items": {"type": "string"}}, "scale_lr": {"title": "Scale Lr", "default": 1.0, "type": "number"}}, "additionalProperties": false}, "CuspCorrectionConfig": {"title": "CuspCorrectionConfig", "description": "Base class for all config models", "type": "object", "properties": {"use": {"title": "Use", "default": true, "type": "boolean"}, "cusp_type": {"title": "Cusp Type", "default": "mo", "enum": ["mo", "ao"], "type": "string"}, "r_cusp_el_ion_scale": {"title": "R Cusp El Ion Scale", "default": 1.0, "type": "number"}}, "additionalProperties": false}, "CASSCFConfig": {"title": "CASSCFConfig", "description": "Base class for all config models", "type": "object", "properties": {"name": {"title": "Name", "default": "casscf", "enum": ["casscf"], "type": "string"}, "basis_set": {"title": "Basis Set", "default": "6-311G", "type": "string"}, "cusps": {"title": "Cusps", "default": {"use": true, "cusp_type": "mo", "r_cusp_el_ion_scale": 1.0}, "allOf": [{"$ref": "#/definitions/CuspCorrectionConfig"}]}, "only_hf": {"title": "Only Hf", "default": false, "type": "boolean"}}, "additionalProperties": false}, "PreTrainingConfig": {"title": "PreTrainingConfig", "description": "Base class for all config models", "type": "object", "properties": {"use": {"title": "Use", "default": true, "type": "boolean"}, "mcmc": {"title": "Mcmc", "default": {"n_inter_steps": 1, "n_burn_in": 0, "max_age": 20, "stepsize_update_interval": 1000, "n_walkers": 2048, "target_acceptance_rate": 0.5, "min_stepsize_scale": 0.01, "max_stepsize_scale": 1.0, "proposal": {"name": "normal"}}, "allOf": [{"$ref": "#/definitions/MCMCConfigPreTrain"}]}, "n_epochs": {"title": "N Epochs", "default": 1000, "type": "integer"}, "optimizer": {"title": "Optimizer", "default": {"name": "adam", "learning_rate": 0.0003, "lr_schedule": {"name": "fixed"}, "scaled_modules": null, "scale_lr": 1.0}, "anyOf": [{"$ref": "#/definitions/_OptimizerConfigAdamForPretraining"}, {"$ref": "#/definitions/StandardOptimizerConfig"}]}, "use_only_leading_determinant": {"title": "Use Only Leading Determinant", "default": true, "type": "boolean"}, "baseline": {"title": "Baseline", "default": {"name": "casscf", "basis_set": "6-311G", "cusps": {"use": true, "cusp_type": "mo", "r_cusp_el_ion_scale": 1.0}, "only_hf": false}, "allOf": [{"$ref": "#/definitions/CASSCFConfig"}]}}, "additionalProperties": false}, "MCMCConfigOptimization": {"title": "MCMCConfigOptimization", "description": "Config for Markov-Chain-Monte-Carlo integration", "type": "object", "properties": {"n_inter_steps": {"title": "N Inter Steps", "default": 20, "type": "integer"}, "n_burn_in": {"title": "N Burn In", "default": 1000, "type": "integer"}, "max_age": {"title": "Max Age", "default": 20, "type": "integer"}, "stepsize_update_interval": {"title": "Stepsize Update Interval", "default": 100, "type": "integer"}, "n_walkers": {"title": "N Walkers", "default": 2048, "type": "integer"}, "target_acceptance_rate": {"title": "Target Acceptance Rate", "default": 0.5, "type": "number"}, "min_stepsize_scale": {"title": "Min Stepsize Scale", "default": 0.01, "type": "number"}, "max_stepsize_scale": {"title": "Max Stepsize Scale", "default": 1.0, "type": "number"}, "proposal": {"title": "Proposal", "default": {"name": "normal"}, "anyOf": [{"$ref": "#/definitions/MCMCSimpleProposalConfig"}, {"$ref": "#/definitions/LocalStepsizeProposalConfig"}, {"$ref": "#/definitions/MCMCLangevinProposalConfig"}]}}, "additionalProperties": false}, "_OptimizerConfigSGD": {"title": "_OptimizerConfigSGD", "description": "Base class for all config models", "type": "object", "properties": {"name": {"title": "Name", "default": "sgd", "enum": ["adam", "rmsprop_momentum", "sgd"], "type": "string"}, "learning_rate": {"title": "Learning Rate", "default": 1.0, "type": "number"}, "lr_schedule": {"title": "Lr Schedule", "default": {"name": "fixed"}, "anyOf": [{"$ref": "#/definitions/InverseLRScheduleConfig"}, {"$ref": "#/definitions/ConstantLRSchedule"}]}, "scaled_modules": {"title": "Scaled Modules", "type": "array", "items": {"type": "string"}}, "scale_lr": {"title": "Scale Lr", "default": 1.0, "type": "number"}}, "additionalProperties": false}, "OptimizerConfigKFAC": {"title": "OptimizerConfigKFAC", "description": "Base class for all config models", "type": "object", "properties": {"name": {"title": "Name", "default": "kfac", "enum": ["kfac"], "type": "string"}, "learning_rate": {"title": "Learning Rate", "default": 0.1, "type": "number"}, "lr_schedule": {"title": "Lr Schedule", "default": {"name": "inverse", "decay_time": 6000.0}, "anyOf": [{"$ref": "#/definitions/InverseLRScheduleConfig"}, {"$ref": "#/definitions/ConstantLRSchedule"}]}, "momentum": {"title": "Momentum", "default": 0.0, "type": "number"}, "norm_constraint": {"title": "Norm Constraint", "default": 0.001, "type": "number"}, "damping": {"title": "Damping", "default": 0.001, "type": "number"}, "damping_scheduler": {"title": "Damping Scheduler", "default": false, "type": "boolean"}, "estimation_mode": {"title": "Estimation Mode", "default": "fisher_exact", "enum": ["fisher_gradients", "fisher_exact"], "type": "string"}, "register_generic": {"title": "Register Generic", "default": false, "type": "boolean"}, "update_inverse_period": {"title": "Update Inverse Period", "default": 1, "type": "integer"}, "n_burn_in": {"title": "N Burn In", "default": 0, "type": "integer"}, "min_damping": {"title": "Min Damping", "default": 0.0001, "type": "number"}, "curvature_ema": {"title": "Curvature Ema", "default": 0.95, "type": "number"}, "internal_optimizer": {"title": "Internal Optimizer", "default": {"name": "sgd", "learning_rate": 1.0, "lr_schedule": {"name": "fixed"}, "scaled_modules": null, "scale_lr": 1.0}, "anyOf": [{"$ref": "#/definitions/_OptimizerConfigSGD"}, {"$ref": "#/definitions/StandardOptimizerConfig"}]}}, "additionalProperties": false}, "_InverseLRScheduleConfigForKFACwithAdam": {"title": "_InverseLRScheduleConfigForKFACwithAdam", "description": "Base class for all config models", "type": "object", "properties": {"name": {"title": "Name", "default": "inverse", "enum": ["inverse"], "type": "string"}, "decay_time": {"title": "Decay Time", "default": 1000, "type": "number"}}, "additionalProperties": false}, "_OptimizerConfigAdamForKFAC": {"title": "_OptimizerConfigAdamForKFAC", "description": "Base class for all config models", "type": "object", "properties": {"name": {"title": "Name", "default": "adam", "enum": ["adam", "rmsprop_momentum", "sgd"], "type": "string"}, "learning_rate": {"title": "Learning Rate", "default": 0.002, "type": "number"}, "lr_schedule": {"title": "Lr Schedule", "default": {"name": "inverse", "decay_time": 1000}, "anyOf": [{"$ref": "#/definitions/_InverseLRScheduleConfigForKFACwithAdam"}, {"$ref": "#/definitions/InverseLRScheduleConfig"}, {"$ref": "#/definitions/ConstantLRSchedule"}]}, "scaled_modules": {"title": "Scaled Modules", "type": "array", "items": {"type": "string"}}, "scale_lr": {"title": "Scale Lr", "default": 1.0, "type": "number"}}, "additionalProperties": false}, "_OptimizerConfigKFACwithAdam": {"title": "_OptimizerConfigKFACwithAdam", "description": "Base class for all config models", "type": "object", "properties": {"name": {"title": "Name", "default": "kfac_adam", "enum": ["kfac_adam"], "type": "string"}, "learning_rate": {"title": "Learning Rate", "default": 1.0, "type": "number"}, "lr_schedule": {"title": "Lr Schedule", "default": {"name": "inverse", "decay_time": 1000}, "anyOf": [{"$ref": "#/definitions/_InverseLRScheduleConfigForKFACwithAdam"}, {"$ref": "#/definitions/InverseLRScheduleConfig"}, {"$ref": "#/definitions/ConstantLRSchedule"}]}, "momentum": {"title": "Momentum", "default": 0.0, "type": "number"}, "norm_constraint": {"title": "Norm Constraint", "default": 6e-05, "type": "number"}, "damping": {"title": "Damping", "default": 0.001, "type": "number"}, "damping_scheduler": {"title": "Damping Scheduler", "default": false, "type": "boolean"}, "estimation_mode": {"title": "Estimation Mode", "default": "fisher_exact", "enum": ["fisher_gradients", "fisher_exact"], "type": "string"}, "register_generic": {"title": "Register Generic", "default": false, "type": "boolean"}, "update_inverse_period": {"title": "Update Inverse Period", "default": 1, "type": "integer"}, "n_burn_in": {"title": "N Burn In", "default": 0, "type": "integer"}, "min_damping": {"title": "Min Damping", "default": 0.0001, "type": "number"}, "curvature_ema": {"title": "Curvature Ema", "default": 0.95, "type": "number"}, "internal_optimizer": {"title": "Internal Optimizer", "default": {"name": "adam", "learning_rate": 0.002, "lr_schedule": {"name": "inverse", "decay_time": 1000}, "scaled_modules": null, "scale_lr": 1.0}, "anyOf": [{"$ref": "#/definitions/_OptimizerConfigAdamForKFAC"}, {"$ref": "#/definitions/StandardOptimizerConfig"}]}}, "additionalProperties": false}, "BFGSOptimizerConfig": {"title": "BFGSOptimizerConfig", "description": "Base class for all config models", "type": "object", "properties": {"name": {"title": "Name", "default": "slbfgs", "enum": ["slbfgs"], "type": "string"}, "internal_optimizer": {"title": "Internal Optimizer", "default": {"name": "adam", "learning_rate": 0.001, "lr_schedule": {"name": "inverse", "decay_time": 6000.0}, "scaled_modules": null, "scale_lr": 1.0}, "allOf": [{"$ref": "#/definitions/StandardOptimizerConfig"}]}, "memory_length": {"title": "Memory Length", "default": 2000, "type": "integer"}, "hessian_regularization": {"title": "Hessian Regularization", "default": 100.0, "type": "number"}, "norm_constraint": {"title": "Norm Constraint", "default": 0.0005, "type": "number"}, "use_variance_reduction": {"title": "Use Variance Reduction", "default": false, "type": "boolean"}, "update_hessian_every_n_epochs": {"title": "Update Hessian Every N Epochs", "default": 1, "type": "integer"}}, "additionalProperties": false}, "CheckpointConfig": {"title": "CheckpointConfig", "description": "Base class for all config models", "type": "object", "properties": {"replace_every_n_epochs": {"title": "Replace Every N Epochs", "default": 1000, "type": "integer"}, "keep_every_n_epochs": {"title": "Keep Every N Epochs", "default": 50000, "type": "integer"}, "additional_n_epochs": {"title": "Additional N Epochs", "default": [], "type": "array", "items": {"type": "integer"}}}, "additionalProperties": false}, "ClippingConfig": {"title": "ClippingConfig", "description": "Base class for all config models", "type": "object", "properties": {"name": {"title": "Name", "default": "tanh", "enum": ["hard", "tanh"], "type": "string"}, "width_metric": {"title": "Width Metric", "default": "std", "enum": ["std", "mae"], "type": "string"}, "center": {"title": "Center", "default": "mean", "enum": ["mean", "median"], "type": "string"}, "from_previous_step": {"title": "From Previous Step", "default": true, "type": "boolean"}, "clip_by": {"title": "Clip By", "default": 5.0, "type": "number"}}, "additionalProperties": false}, "IntermediateEvaluationConfig": {"title": "IntermediateEvaluationConfig", "description": "Base class for all config models", "type": "object", "properties": {"n_epochs": {"title": "N Epochs", "default": 5000, "type": "integer"}, "opt_epochs": {"title": "Opt Epochs", "default": [], "type": "array", "items": {"type": "integer"}}}, "additionalProperties": false}, "SharedOptimizationConfig": {"title": "SharedOptimizationConfig", "description": "Base class for all config models", "type": "object", "properties": {"use": {"title": "Use", "default": true, "type": "boolean"}, "shared_modules": {"title": "Shared Modules", "type": "array", "items": {"enum": ["embed", "jastrow", "bf_fac_general", "bf_shift", "bf_fac_orbital"], "type": "string"}}, "scheduling_method": {"title": "Scheduling Method", "default": "round_robin", "enum": ["round_robin", "stddev"], "type": "string"}, "max_age": {"title": "Max Age", "default": 50, "type": "integer"}}, "additionalProperties": false}, "OptimizationConfig": {"title": "OptimizationConfig", "description": "Base class for all config models", "type": "object", "properties": {"mcmc": {"title": "Mcmc", "default": {"n_inter_steps": 20, "n_burn_in": 1000, "max_age": 20, "stepsize_update_interval": 100, "n_walkers": 2048, "target_acceptance_rate": 0.5, "min_stepsize_scale": 0.01, "max_stepsize_scale": 1.0, "proposal": {"name": "normal"}}, "allOf": [{"$ref": "#/definitions/MCMCConfigOptimization"}]}, "optimizer": {"title": "Optimizer", "default": {"name": "kfac", "learning_rate": 0.1, "lr_schedule": {"name": "inverse", "decay_time": 6000.0}, "momentum": 0.0, "norm_constraint": 0.001, "damping": 0.001, "damping_scheduler": false, "estimation_mode": "fisher_exact", "register_generic": false, "update_inverse_period": 1, "n_burn_in": 0, "min_damping": 0.0001, "curvature_ema": 0.95, "internal_optimizer": {"name": "sgd", "learning_rate": 1.0, "lr_schedule": {"name": "fixed"}, "scaled_modules": null, "scale_lr": 1.0}}, "anyOf": [{"$ref": "#/definitions/OptimizerConfigKFAC"}, {"$ref": "#/definitions/_OptimizerConfigKFACwithAdam"}, {"$ref": "#/definitions/StandardOptimizerConfig"}, {"$ref": "#/definitions/BFGSOptimizerConfig"}]}, "n_epochs": {"title": "N Epochs", "default": 60000, "type": "integer"}, "n_epochs_prev": {"title": "N Epochs Prev", "default": 0, "type": "integer"}, "use_batch_reweighting": {"title": "Use Batch Reweighting", "default": false, "type": "boolean"}, "checkpoints": {"title": "Checkpoints", "default": {"replace_every_n_epochs": 1000, "keep_every_n_epochs": 50000, "additional_n_epochs": []}, "allOf": [{"$ref": "#/definitions/CheckpointConfig"}]}, "clipping": {"title": "Clipping", "default": {"name": "tanh", "width_metric": "std", "center": "mean", "from_previous_step": true, "clip_by": 5.0}, "allOf": [{"$ref": "#/definitions/ClippingConfig"}]}, "intermediate_eval": {"$ref": "#/definitions/IntermediateEvaluationConfig"}, "shared_optimization": {"$ref": "#/definitions/SharedOptimizationConfig"}}, "additionalProperties": false}, "MCMCConfigEvaluation": {"title": "MCMCConfigEvaluation", "description": "Config for Markov-Chain-Monte-Carlo integration", "type": "object", "properties": {"n_inter_steps": {"title": "N Inter Steps", "default": 20, "type": "integer"}, "n_burn_in": {"title": "N Burn In", "default": 500, "type": "integer"}, "max_age": {"title": "Max Age", "default": 100, "type": "integer"}, "stepsize_update_interval": {"title": "Stepsize Update Interval", "default": 100, "type": "integer"}, "n_walkers": {"title": "N Walkers", "default": 2048, "type": "integer"}, "target_acceptance_rate": {"title": "Target Acceptance Rate", "default": 0.5, "type": "number"}, "min_stepsize_scale": {"title": "Min Stepsize Scale", "default": 0.01, "type": "number"}, "max_stepsize_scale": {"title": "Max Stepsize Scale", "default": 1.0, "type": "number"}, "proposal": {"title": "Proposal", "default": {"name": "normal"}, "anyOf": [{"$ref": "#/definitions/MCMCSimpleProposalConfig"}, {"$ref": "#/definitions/LocalStepsizeProposalConfig"}, {"$ref": "#/definitions/MCMCLangevinProposalConfig"}]}}, "additionalProperties": false}, "ForceEvaluationConfig": {"title": "ForceEvaluationConfig", "description": "Base class for all config models", "type": "object", "properties": {"use": {"title": "Use", "default": true, "type": "boolean"}, "R_cut": {"title": "R Cut", "default": 0.1, "type": "number"}, "R_core": {"title": "R Core", "default": 0.5, "type": "number"}, "use_antithetic_sampling": {"title": "Use Antithetic Sampling", "default": false, "type": "boolean"}}, "additionalProperties": false}, "EvaluationConfig": {"title": "EvaluationConfig", "description": "Base class for all config models", "type": "object", "properties": {"mcmc": {"title": "Mcmc", "default": {"n_inter_steps": 20, "n_burn_in": 500, "max_age": 100, "stepsize_update_interval": 100, "n_walkers": 2048, "target_acceptance_rate": 0.5, "min_stepsize_scale": 0.01, "max_stepsize_scale": 1.0, "proposal": {"name": "normal"}}, "allOf": [{"$ref": "#/definitions/MCMCConfigEvaluation"}]}, "n_epochs": {"title": "N Epochs", "default": 10000, "type": "integer"}, "calculate_energies": {"title": "Calculate Energies", "default": true, "type": "boolean"}, "forces": {"$ref": "#/definitions/ForceEvaluationConfig"}}, "additionalProperties": false}, "InputFeatureConfigDPE4": {"title": "InputFeatureConfigDPE4", "description": "DO NOT INTRODUCE NEW FIELDS HERE. This class is only used to provide alternative defaults", "type": "object", "properties": {"use_rbf_features": {"title": "Use Rbf Features", "default": false, "type": "boolean"}, "n_rbf_features": {"title": "N Rbf Features", "default": 0, "type": "integer"}, "use_distance_features": {"title": "Use Distance Features", "default": true, "type": "boolean"}, "use_el_ion_differences": {"title": "Use El Ion Differences", "default": true, "type": "boolean"}, "use_el_el_differences": {"title": "Use El El Differences", "default": false, "type": "boolean"}, "use_el_el_spin": {"title": "Use El El Spin", "default": false, "type": "boolean"}, "use_local_coordinates": {"title": "Use Local Coordinates", "default": true, "type": "boolean"}, "n_one_el_features": {"title": "N One El Features", "default": 0, "type": "integer"}, "n_ion_features": {"title": "N Ion Features", "default": 32, "type": "integer"}, "concatenate_el_ion_features": {"title": "Concatenate El Ion Features", "default": true, "type": "boolean"}, "n_hidden_one_el_features": {"title": "N Hidden One El Features", "default": [], "type": "array", "items": {"type": "integer"}}, "eps_dist_feat": {"title": "Eps Dist Feat", "default": 0.01, "type": "number"}, "distance_feature_powers": {"title": "Distance Feature Powers", "default": [1], "type": "array", "items": {"type": "integer"}}, "name": {"title": "Name", "default": "dpe4", "enum": ["dpe4"], "type": "string"}}, "additionalProperties": false}, "InputFeatureConfigFermiNet": {"title": "InputFeatureConfigFermiNet", "description": "DO NOT INTRODUCE NEW FIELDS HERE. This class is only used to provide alternative defaults", "type": "object", "properties": {"use_rbf_features": {"title": "Use Rbf Features", "default": false, "type": "boolean"}, "n_rbf_features": {"title": "N Rbf Features", "default": 0, "type": "integer"}, "use_distance_features": {"title": "Use Distance Features", "default": true, "type": "boolean"}, "use_el_ion_differences": {"title": "Use El Ion Differences", "default": true, "type": "boolean"}, "use_el_el_differences": {"title": "Use El El Differences", "default": true, "type": "boolean"}, "use_el_el_spin": {"title": "Use El El Spin", "default": false, "type": "boolean"}, "use_local_coordinates": {"title": "Use Local Coordinates", "default": false, "type": "boolean"}, "n_one_el_features": {"title": "N One El Features", "default": 0, "type": "integer"}, "n_ion_features": {"title": "N Ion Features", "default": 32, "type": "integer"}, "concatenate_el_ion_features": {"title": "Concatenate El Ion Features", "default": true, "type": "boolean"}, "n_hidden_one_el_features": {"title": "N Hidden One El Features", "default": [], "type": "array", "items": {"type": "integer"}}, "eps_dist_feat": {"title": "Eps Dist Feat", "default": 0.01, "type": "number"}, "distance_feature_powers": {"title": "Distance Feature Powers", "default": [1], "type": "array", "items": {"type": "integer"}}, "name": {"title": "Name", "default": "ferminet", "enum": ["ferminet"], "type": "string"}}, "additionalProperties": false}, "InputFeatureConfigDPE1": {"title": "InputFeatureConfigDPE1", "description": "DO NOT INTRODUCE NEW FIELDS HERE. This class is only used to provide alternative defaults", "type": "object", "properties": {"use_rbf_features": {"title": "Use Rbf Features", "default": true, "type": "boolean"}, "n_rbf_features": {"title": "N Rbf Features", "default": 32, "type": "integer"}, "use_distance_features": {"title": "Use Distance Features", "default": true, "type": "boolean"}, "use_el_ion_differences": {"title": "Use El Ion Differences", "default": false, "type": "boolean"}, "use_el_el_differences": {"title": "Use El El Differences", "default": false, "type": "boolean"}, "use_el_el_spin": {"title": "Use El El Spin", "default": false, "type": "boolean"}, "use_local_coordinates": {"title": "Use Local Coordinates", "default": false, "type": "boolean"}, "n_one_el_features": {"title": "N One El Features", "default": 0, "type": "integer"}, "n_ion_features": {"title": "N Ion Features", "default": 0, "type": "integer"}, "concatenate_el_ion_features": {"title": "Concatenate El Ion Features", "default": false, "type": "boolean"}, "n_hidden_one_el_features": {"title": "N Hidden One El Features", "default": [], "type": "array", "items": {"type": "integer"}}, "eps_dist_feat": {"title": "Eps Dist Feat", "default": 0.01, "type": "number"}, "distance_feature_powers": {"title": "Distance Feature Powers", "default": [-1], "type": "array", "items": {"type": "integer"}}, "name": {"title": "Name", "default": "dpe1", "enum": ["dpe1"], "type": "string"}}, "additionalProperties": false}, "InitializationConfig": {"title": "InitializationConfig", "description": "Base class for all config models", "type": "object", "properties": {"bias_scale": {"title": "Bias Scale", "default": 0.0, "type": "number"}, "weight_scale": {"title": "Weight Scale", "default": "glorot", "enum": ["glorot", "glorot-input"], "type": "string"}, "weight_distribution": {"title": "Weight Distribution", "default": "uniform", "enum": ["normal", "uniform"], "type": "string"}}, "additionalProperties": false}, "EmbeddingConfigDeepErwin4": {"title": "EmbeddingConfigDeepErwin4", "description": "DO NOT INTRODUCE NEW FIELDS HERE. This class is only used to provide alternative defaults", "type": "object", "properties": {"name": {"title": "Name", "default": "dpe4", "enum": ["dpe4"], "type": "string"}, "n_hidden_one_el": {"title": "N Hidden One El", "default": 256, "anyOf": [{"type": "array", "items": {"type": "integer"}}, {"type": "integer"}]}, "n_hidden_two_el": {"title": "N Hidden Two El", "default": 32, "anyOf": [{"type": "array", "items": {"type": "integer"}}, {"type": "integer"}]}, "n_hidden_el_ions": {"title": "N Hidden El Ions", "default": 32, "anyOf": [{"type": "array", "items": {"type": "integer"}}, {"type": "integer"}]}, "n_iterations": {"title": "N Iterations", "default": 4, "type": "integer"}, "use_el_ion_stream": {"title": "Use El Ion Stream", "default": true, "type": "boolean"}, "use_average_h_one": {"title": "Use Average H One", "default": true, "type": "boolean"}, "initialization": {"title": "Initialization", "default": {"bias_scale": 0.0, "weight_scale": "glorot", "weight_distribution": "uniform"}, "allOf": [{"$ref": "#/definitions/InitializationConfig"}]}, "use_average_h_two": {"title": "Use Average H Two", "default": false, "type": "boolean"}, "use_h_one": {"title": "Use H One", "default": true, "type": "boolean"}, "use_h_two_same_diff": {"title": "Use H Two Same Diff", "default": true, "type": "boolean"}, "use_schnet_features": {"title": "Use Schnet Features", "default": true, "type": "boolean"}, "sum_schnet_features": {"title": "Sum Schnet Features", "default": false, "type": "boolean"}, "emb_dim": {"title": "Emb Dim", "default": 32, "type": "integer"}, "use_linear_out": {"title": "Use Linear Out", "default": false, "type": "boolean"}, "use_w_mapping": {"title": "Use W Mapping", "default": true, "type": "boolean"}}, "additionalProperties": false}, "EmbeddingConfigFermiNet": {"title": "EmbeddingConfigFermiNet", "description": "Base class for all config models", "type": "object", "properties": {"name": {"title": "Name", "default": "ferminet", "enum": ["ferminet"], "type": "string"}, "n_hidden_one_el": {"title": "N Hidden One El", "default": 256, "anyOf": [{"type": "array", "items": {"type": "integer"}}, {"type": "integer"}]}, "n_hidden_two_el": {"title": "N Hidden Two El", "default": 32, "anyOf": [{"type": "array", "items": {"type": "integer"}}, {"type": "integer"}]}, "n_hidden_el_ions": {"title": "N Hidden El Ions", "default": 32, "anyOf": [{"type": "array", "items": {"type": "integer"}}, {"type": "integer"}]}, "n_iterations": {"title": "N Iterations", "default": 4, "type": "integer"}, "use_el_ion_stream": {"title": "Use El Ion Stream", "default": false, "type": "boolean"}, "use_average_h_one": {"title": "Use Average H One", "default": true, "type": "boolean"}, "initialization": {"title": "Initialization", "default": {"bias_scale": 0.0, "weight_scale": "glorot", "weight_distribution": "uniform"}, "allOf": [{"$ref": "#/definitions/InitializationConfig"}]}, "use_average_h_two": {"title": "Use Average H Two", "default": true, "type": "boolean"}, "use_h_one": {"title": "Use H One", "default": true, "type": "boolean"}, "use_h_two_same_diff": {"title": "Use H Two Same Diff", "default": false, "type": "boolean"}, "use_schnet_features": {"title": "Use Schnet Features", "default": false, "type": "boolean"}, "sum_schnet_features": {"title": "Sum Schnet Features", "default": true, "type": "boolean"}, "emb_dim": {"title": "Emb Dim", "default": 128, "type": "integer"}, "use_linear_out": {"title": "Use Linear Out", "default": false, "type": "boolean"}, "use_w_mapping": {"title": "Use W Mapping", "default": false, "type": "boolean"}}, "additionalProperties": false}, "EmbeddingConfigDeepErwin1": {"title": "EmbeddingConfigDeepErwin1", "description": "Base class for all config models", "type": "object", "properties": {"name": {"title": "Name", "default": "dpe1", "enum": ["dpe1"], "type": "string"}, "embedding_dim": {"title": "Embedding Dim", "default": 64, "type": "integer"}, "n_iterations": {"title": "N Iterations", "default": 2, "type": "integer"}, "n_hidden_w": {"title": "N Hidden W", "default": [40, 40], "type": "array", "items": {"type": "integer"}}, "n_hidden_h": {"title": "N Hidden H", "default": [40, 40], "type": "array", "items": {"type": "integer"}}, "n_hidden_g": {"title": "N Hidden G", "default": [40], "type": "array", "items": {"type": "integer"}}, "use_res_net": {"title": "Use Res Net", "default": false, "type": "boolean"}, "one_el_input": {"title": "One El Input", "default": false, "type": "boolean"}, "deep_w": {"title": "Deep W", "default": false, "type": "boolean"}, "use_linear_layer_w": {"title": "Use Linear Layer W", "default": true, "type": "boolean"}}, "additionalProperties": false}, "BaselineOrbitalsConfig": {"title": "BaselineOrbitalsConfig", "description": "Base class for all config models", "type": "object", "properties": {"baseline": {"title": "Baseline", "default": {"name": "casscf", "basis_set": "6-311G", "cusps": {"use": true, "cusp_type": "mo", "r_cusp_el_ion_scale": 1.0}, "only_hf": false}, "allOf": [{"$ref": "#/definitions/CASSCFConfig"}]}, "use_trainable_scales": {"title": "Use Trainable Scales", "default": true, "type": "boolean"}, "use_bf_shift": {"title": "Use Bf Shift", "default": true, "type": "boolean"}, "use_trainable_shift_decay_radius": {"title": "Use Trainable Shift Decay Radius", "default": true, "type": "boolean"}, "n_hidden_bf_factor": {"title": "N Hidden Bf Factor", "default": [40, 20, 20], "type": "array", "items": {"type": "integer"}}, "n_hidden_bf_shift": {"title": "N Hidden Bf Shift", "default": [40, 40], "type": "array", "items": {"type": "integer"}}, "use_bf_factor": {"title": "Use Bf Factor", "default": true, "type": "boolean"}, "use_bf_factor_bias": {"title": "Use Bf Factor Bias", "default": true, "type": "boolean"}, "bf_factor_constant_bias": {"title": "Bf Factor Constant Bias", "default": 1.0, "type": "number"}, "output_shift": {"title": "Output Shift", "default": 1, "enum": [1, 3], "type": "integer"}, "register_scale": {"title": "Register Scale", "default": false, "type": "boolean"}}, "additionalProperties": false}, "EnvelopeOrbitalsConfig": {"title": "EnvelopeOrbitalsConfig", "description": "Base class for all config models", "type": "object", "properties": {"envelope_type": {"title": "Envelope Type", "default": "isotropic_exp", "enum": ["isotropic_exp"], "type": "string"}, "n_hidden": {"title": "N Hidden", "default": [], "type": "array", "items": {"type": "integer"}}, "use_bias": {"title": "Use Bias", "default": false, "type": "boolean"}, "initialization": {"title": "Initialization", "default": "constant", "enum": ["constant", "analytical"], "type": "string"}}, "additionalProperties": false}, "OrbitalsConfigFermiNet": {"title": "OrbitalsConfigFermiNet", "description": "Base class for all config models", "type": "object", "properties": {"baseline_orbitals": {"$ref": "#/definitions/BaselineOrbitalsConfig"}, "envelope_orbitals": {"title": "Envelope Orbitals", "default": {"envelope_type": "isotropic_exp", "n_hidden": [], "use_bias": false, "initialization": "constant"}, "allOf": [{"$ref": "#/definitions/EnvelopeOrbitalsConfig"}]}, "n_determinants": {"title": "N Determinants", "default": 32, "type": "integer"}, "use_full_det": {"title": "Use Full Det", "default": true, "type": "boolean"}}, "additionalProperties": false}, "MLPConfig": {"title": "MLPConfig", "description": "Base class for all config models", "type": "object", "properties": {"activation": {"title": "Activation", "default": "tanh", "enum": ["tanh", "silu", "elu", "relu"], "type": "string"}, "init_bias_scale": {"title": "Init Bias Scale", "default": 0.0, "type": "number"}, "init_weights_scale": {"title": "Init Weights Scale", "default": "fan_avg", "enum": ["fan_in", "fan_out", "fan_avg"], "type": "string"}, "init_weights_distribution": {"title": "Init Weights Distribution", "default": "uniform", "enum": ["normal", "truncated_normal", "uniform"], "type": "string"}}, "additionalProperties": false}, "JastrowConfig": {"title": "JastrowConfig", "description": "Base class for all config models", "type": "object", "properties": {"use": {"title": "Use", "default": true, "type": "boolean"}, "n_hidden": {"title": "N Hidden", "default": [40, 40], "type": "array", "items": {"type": "integer"}}, "differentiate_spins": {"title": "Differentiate Spins", "default": false, "type": "boolean"}}, "additionalProperties": false}, "ModelConfigDeepErwin4": {"title": "ModelConfigDeepErwin4", "description": "DO NOT INTRODUCE NEW FIELDS HERE. This class is only used to provide alternative defaults", "type": "object", "properties": {"features": {"title": "Features", "default": {"use_rbf_features": false, "n_rbf_features": 0, "use_distance_features": true, "use_el_ion_differences": true, "use_el_el_differences": false, "use_el_el_spin": false, "use_local_coordinates": true, "n_one_el_features": 0, "n_ion_features": 32, "concatenate_el_ion_features": true, "n_hidden_one_el_features": [], "eps_dist_feat": 0.01, "distance_feature_powers": [1], "name": "dpe4"}, "anyOf": [{"$ref": "#/definitions/InputFeatureConfigDPE4"}, {"$ref": "#/definitions/InputFeatureConfigFermiNet"}, {"$ref": "#/definitions/InputFeatureConfigDPE1"}]}, "embedding": {"title": "Embedding", "default": {"name": "dpe4", "n_hidden_one_el": [256, 256, 256, 256], "n_hidden_two_el": [32, 32, 32], "n_hidden_el_ions": [32, 32, 32], "n_iterations": 4, "use_el_ion_stream": true, "use_average_h_one": true, "initialization": {"bias_scale": 0.0, "weight_scale": "glorot", "weight_distribution": "uniform"}, "use_average_h_two": false, "use_h_one": true, "use_h_two_same_diff": true, "use_schnet_features": true, "sum_schnet_features": false, "emb_dim": 32, "use_linear_out": false, "use_w_mapping": true}, "anyOf": [{"$ref": "#/definitions/EmbeddingConfigDeepErwin4"}, {"$ref": "#/definitions/EmbeddingConfigFermiNet"}, {"$ref": "#/definitions/EmbeddingConfigDeepErwin1"}]}, "orbitals": {"title": "Orbitals", "default": {"baseline_orbitals": null, "envelope_orbitals": {"envelope_type": "isotropic_exp", "n_hidden": [], "use_bias": false, "initialization": "constant"}, "n_determinants": 32, "use_full_det": true}, "allOf": [{"$ref": "#/definitions/OrbitalsConfigFermiNet"}]}, "mlp": {"title": "Mlp", "default": {"activation": "tanh", "init_bias_scale": 0.0, "init_weights_scale": "fan_avg", "init_weights_distribution": "uniform"}, "allOf": [{"$ref": "#/definitions/MLPConfig"}]}, "jastrow": {"$ref": "#/definitions/JastrowConfig"}, "use_el_el_cusp_correction": {"title": "Use El El Cusp Correction", "default": false, "type": "boolean"}, "name": {"title": "Name", "default": "dpe4", "enum": ["dpe4"], "type": "string"}}, "additionalProperties": false}, "ModelConfigFermiNet": {"title": "ModelConfigFermiNet", "description": "DO NOT INTRODUCE NEW FIELDS HERE. This class is only used to provide alternative defaults", "type": "object", "properties": {"features": {"title": "Features", "default": {"use_rbf_features": false, "n_rbf_features": 0, "use_distance_features": true, "use_el_ion_differences": true, "use_el_el_differences": true, "use_el_el_spin": false, "use_local_coordinates": false, "n_one_el_features": 0, "n_ion_features": 32, "concatenate_el_ion_features": true, "n_hidden_one_el_features": [], "eps_dist_feat": 0.01, "distance_feature_powers": [1], "name": "ferminet"}, "anyOf": [{"$ref": "#/definitions/InputFeatureConfigFermiNet"}, {"$ref": "#/definitions/InputFeatureConfigDPE1"}]}, "embedding": {"title": "Embedding", "default": {"name": "ferminet", "n_hidden_one_el": [256, 256, 256, 256], "n_hidden_two_el": [32, 32, 32], "n_hidden_el_ions": [32, 32, 32], "n_iterations": 4, "use_el_ion_stream": false, "use_average_h_one": true, "initialization": {"bias_scale": 0.0, "weight_scale": "glorot", "weight_distribution": "uniform"}, "use_average_h_two": true, "use_h_one": true, "use_h_two_same_diff": false, "use_schnet_features": false, "sum_schnet_features": true, "emb_dim": 128, "use_linear_out": false, "use_w_mapping": false}, "anyOf": [{"$ref": "#/definitions/EmbeddingConfigFermiNet"}, {"$ref": "#/definitions/EmbeddingConfigDeepErwin4"}, {"$ref": "#/definitions/EmbeddingConfigDeepErwin1"}]}, "orbitals": {"title": "Orbitals", "default": {"baseline_orbitals": null, "envelope_orbitals": {"envelope_type": "isotropic_exp", "n_hidden": [], "use_bias": false, "initialization": "constant"}, "n_determinants": 32, "use_full_det": true}, "allOf": [{"$ref": "#/definitions/OrbitalsConfigFermiNet"}]}, "mlp": {"title": "Mlp", "default": {"activation": "tanh", "init_bias_scale": 0.0, "init_weights_scale": "fan_avg", "init_weights_distribution": "uniform"}, "allOf": [{"$ref": "#/definitions/MLPConfig"}]}, "jastrow": {"$ref": "#/definitions/JastrowConfig"}, "use_el_el_cusp_correction": {"title": "Use El El Cusp Correction", "default": false, "type": "boolean"}, "name": {"title": "Name", "default": "ferminet", "enum": ["ferminet"], "type": "string"}}, "additionalProperties": false}, "OrbitalsConfigDPE1": {"title": "OrbitalsConfigDPE1", "description": "Base class for all config models", "type": "object", "properties": {"baseline_orbitals": {"title": "Baseline Orbitals", "default": {"baseline": {"name": "casscf", "basis_set": "6-311G", "cusps": {"use": true, "cusp_type": "mo", "r_cusp_el_ion_scale": 1.0}, "only_hf": false}, "use_trainable_scales": true, "use_bf_shift": true, "use_trainable_shift_decay_radius": true, "n_hidden_bf_factor": [40, 20, 20], "n_hidden_bf_shift": [40, 40], "use_bf_factor": true, "use_bf_factor_bias": true, "bf_factor_constant_bias": 1.0, "output_shift": 1, "register_scale": false}, "allOf": [{"$ref": "#/definitions/BaselineOrbitalsConfig"}]}, "envelope_orbitals": {"$ref": "#/definitions/EnvelopeOrbitalsConfig"}, "n_determinants": {"title": "N Determinants", "default": 20, "type": "integer"}, "use_full_det": {"title": "Use Full Det", "default": false, "type": "boolean"}}, "additionalProperties": false}, "ModelConfigDeepErwin1": {"title": "ModelConfigDeepErwin1", "description": "DO NOT INTRODUCE NEW FIELDS HERE. This class is only used to provide alternative defaults", "type": "object", "properties": {"features": {"title": "Features", "default": {"use_rbf_features": true, "n_rbf_features": 32, "use_distance_features": true, "use_el_ion_differences": false, "use_el_el_differences": false, "use_el_el_spin": false, "use_local_coordinates": false, "n_one_el_features": 0, "n_ion_features": 0, "concatenate_el_ion_features": false, "n_hidden_one_el_features": [], "eps_dist_feat": 0.01, "distance_feature_powers": [-1], "name": "dpe1"}, "anyOf": [{"$ref": "#/definitions/InputFeatureConfigDPE1"}, {"$ref": "#/definitions/InputFeatureConfigFermiNet"}]}, "embedding": {"title": "Embedding", "default": {"name": "dpe1", "embedding_dim": 64, "n_iterations": 2, "n_hidden_w": [40, 40], "n_hidden_h": [40, 40], "n_hidden_g": [40], "use_res_net": false, "one_el_input": false, "deep_w": false, "use_linear_layer_w": true}, "anyOf": [{"$ref": "#/definitions/EmbeddingConfigDeepErwin1"}, {"$ref": "#/definitions/EmbeddingConfigDeepErwin4"}, {"$ref": "#/definitions/EmbeddingConfigFermiNet"}]}, "orbitals": {"title": "Orbitals", "default": {"baseline_orbitals": {"baseline": {"name": "casscf", "basis_set": "6-311G", "cusps": {"use": true, "cusp_type": "mo", "r_cusp_el_ion_scale": 1.0}, "only_hf": false}, "use_trainable_scales": true, "use_bf_shift": true, "use_trainable_shift_decay_radius": true, "n_hidden_bf_factor": [40, 20, 20], "n_hidden_bf_shift": [40, 40], "use_bf_factor": true, "use_bf_factor_bias": true, "bf_factor_constant_bias": 1.0, "output_shift": 1, "register_scale": false}, "envelope_orbitals": null, "n_determinants": 20, "use_full_det": false}, "allOf": [{"$ref": "#/definitions/OrbitalsConfigDPE1"}]}, "mlp": {"title": "Mlp", "default": {"activation": "tanh", "init_bias_scale": 0.0, "init_weights_scale": "fan_avg", "init_weights_distribution": "uniform"}, "allOf": [{"$ref": "#/definitions/MLPConfig"}]}, "jastrow": {"title": "Jastrow", "default": {"use": true, "n_hidden": [40, 40], "differentiate_spins": false}, "allOf": [{"$ref": "#/definitions/JastrowConfig"}]}, "use_el_el_cusp_correction": {"title": "Use El El Cusp Correction", "default": true, "type": "boolean"}, "name": {"title": "Name", "default": "dpe1", "enum": ["dpe1"], "type": "string"}}, "additionalProperties": false}, "BasicLoggerConfig": {"title": "BasicLoggerConfig", "description": "Base class for all config models", "type": "object", "properties": {"n_skip_epochs": {"title": "N Skip Epochs", "default": 9, "type": "integer"}, "log_to_stdout": {"title": "Log To Stdout", "default": true, "type": "boolean"}, "log_level": {"title": "Log Level", "default": "DEBUG", "anyOf": [{"type": "integer"}, {"enum": ["CRITICAL", "FATAL", "ERROR", "WARN", "WARNING", "INFO", "DEBUG"], "type": "string"}]}, "fname": {"title": "Fname", "default": "log.out", "type": "string"}}, "additionalProperties": false}, "WandBConfig": {"title": "WandBConfig", "description": "Base class for all config models", "type": "object", "properties": {"n_skip_epochs": {"title": "N Skip Epochs", "default": 0, "type": "integer"}, "project": {"title": "Project", "default": "default", "type": "string"}, "entity": {"title": "Entity", "type": "string"}, "id": {"title": "Id", "type": "string"}, "use_id": {"title": "Use Id", "default": false, "type": "boolean"}, "blacklist": {"title": "Blacklist", "default": [], "type": "array", "items": {"type": "string"}}}, "additionalProperties": false}, "PickleLoggerConfig": {"title": "PickleLoggerConfig", "description": "Base class for all config models", "type": "object", "properties": {"n_skip_epochs": {"title": "N Skip Epochs", "default": 0, "type": "integer"}, "fname": {"title": "Fname", "default": "results.bz2", "type": "string"}}, "additionalProperties": false}, "LoggingConfig": {"title": "LoggingConfig", "description": "Base class for all config models", "type": "object", "properties": {"tags": {"title": "Tags", "default": [], "type": "array", "items": {"type": "string"}}, "log_opt_state": {"title": "Log Opt State", "default": true, "type": "boolean"}, "basic": {"title": "Basic", "default": {"n_skip_epochs": 9, "log_to_stdout": true, "log_level": "DEBUG", "fname": "log.out"}, "allOf": [{"$ref": "#/definitions/BasicLoggerConfig"}]}, "wandb": {"$ref": "#/definitions/WandBConfig"}, "pickle": {"title": "Pickle", "default": {"n_skip_epochs": 0, "fname": "results.bz2"}, "allOf": [{"$ref": "#/definitions/PickleLoggerConfig"}]}}, "additionalProperties": false}, "ComputationConfig": {"title": "ComputationConfig", "description": "Base class for all config models", "type": "object", "properties": {"use_gpu": {"title": "Use Gpu", "default": true, "type": "boolean"}, "require_gpu": {"title": "Require Gpu", "default": true, "type": "boolean"}, "n_devices": {"title": "N Devices", "type": "integer"}, "force_device_count": {"title": "Force Device Count", "default": false, "type": "boolean"}, "disable_jit": {"title": "Disable Jit", "default": false, "type": "boolean"}, "float_precision": {"title": "Float Precision", "default": "float32", "enum": ["float32", "float64"], "type": "string"}, "disable_tensor_cores": {"title": "Disable Tensor Cores", "default": true, "type": "boolean"}, "use_profiler": {"title": "Use Profiler", "default": false, "type": "boolean"}}, "additionalProperties": false}, "DispatchConfig": {"title": "DispatchConfig", "description": "Base class for all config models", "type": "object", "properties": {"system": {"title": "System", "default": "auto", "enum": ["local", "local_background", "vsc3", "vsc4", "dgx", "auto"], "type": "string"}, "queue": {"title": "Queue", "default": "default", "enum": ["default", "vsc3plus_0064", "devel_0128", "gpu_a40dual", "gpu_gtx1080amd", "gpu_gtx1080multi", "gpu_gtx1080single", "gpu_v100", "gpu_k20m", "gpu_rtx2080ti", "jupyter", "normal_binf", "vsc3plus_0256", "mem_0096", "devel_0096", "jupyter", "mem_0096", "mem_0384", "mem_0768"], "type": "string"}, "time": {"title": "Time", "default": "3day", "type": "string"}, "conda_env": {"title": "Conda Env", "default": "jax", "type": "string"}, "split_opt": {"title": "Split Opt", "type": "array", "items": {"type": "integer"}}, "eval_epochs": {"title": "Eval Epochs", "type": "integer"}}, "additionalProperties": false}, "RestartConfig": {"title": "RestartConfig", "description": "Base class for all config models", "type": "object", "properties": {"mode": {"title": "Mode", "default": "restart", "enum": ["restart"], "type": "string"}, "path": {"title": "Path", "type": "string"}, "reuse_config": {"title": "Reuse Config", "default": true, "type": "boolean"}, "reuse_opt_state": {"title": "Reuse Opt State", "default": true, "type": "boolean"}, "reuse_mcmc_state": {"title": "Reuse Mcmc State", "default": true, "type": "boolean"}, "randomize_mcmc_rng": {"title": "Randomize Mcmc Rng", "default": false, "type": "boolean"}, "reuse_clipping_state": {"title": "Reuse Clipping State", "default": true, "type": "boolean"}, "reuse_trainable_params": {"title": "Reuse Trainable Params", "default": true, "type": "boolean"}, "reuse_fixed_params": {"title": "Reuse Fixed Params", "default": true, "type": "boolean"}, "reuse_modules": {"title": "Reuse Modules", "type": "array", "items": {"type": "string"}}, "continue_n_epochs": {"title": "Continue N Epochs", "default": true, "type": "boolean"}, "skip_burn_in": {"title": "Skip Burn In", "default": true, "type": "boolean"}, "skip_pretraining": {"title": "Skip Pretraining", "default": true, "type": "boolean"}, "ignore_extra_settings": {"title": "Ignore Extra Settings", "default": false, "type": "boolean"}}, "required": ["path"], "additionalProperties": false}, "ReuseConfig": {"title": "ReuseConfig", "description": "Do not introduce new fields here", "type": "object", "properties": {"mode": {"title": "Mode", "default": "reuse", "enum": ["reuse"], "type": "string"}, "path": {"title": "Path", "type": "string"}, "reuse_config": {"title": "Reuse Config", "default": false, "type": "boolean"}, "reuse_opt_state": {"title": "Reuse Opt State", "default": false, "type": "boolean"}, "reuse_mcmc_state": {"title": "Reuse Mcmc State", "default": false, "type": "boolean"}, "randomize_mcmc_rng": {"title": "Randomize Mcmc Rng", "default": false, "type": "boolean"}, "reuse_clipping_state": {"title": "Reuse Clipping State", "default": false, "type": "boolean"}, "reuse_trainable_params": {"title": "Reuse Trainable Params", "default": true, "type": "boolean"}, "reuse_fixed_params": {"title": "Reuse Fixed Params", "default": false, "type": "boolean"}, "reuse_modules": {"title": "Reuse Modules", "type": "array", "items": {"type": "string"}}, "continue_n_epochs": {"title": "Continue N Epochs", "default": false, "type": "boolean"}, "skip_burn_in": {"title": "Skip Burn In", "default": false, "type": "boolean"}, "skip_pretraining": {"title": "Skip Pretraining", "default": false, "type": "boolean"}, "ignore_extra_settings": {"title": "Ignore Extra Settings", "default": false, "type": "boolean"}}, "required": ["path"], "additionalProperties": false}}}